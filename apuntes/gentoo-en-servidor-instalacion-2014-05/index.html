<!doctype html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="En cantidad de programas y tiempo requerido, instalar un servidor requiere menos de los dos. Pero siempre, gracias a las ventajas de Gentoo Linux, cuidaremos que su desempeño y seguridad sean de lo mejor.">
    <meta name="keywords" content="gentoo linux, apuntes">
    <meta name="author" content="Guillermo Valdés Lozano (guivaloz)">
    <meta itemprop="name" content="Instalación de Gentoo Linux para un servidor">
    <meta itemprop="description" content="En cantidad de programas y tiempo requerido, instalar un servidor requiere menos de los dos. Pero siempre, gracias a las ventajas de Gentoo Linux, cuidaremos que su desempeño y seguridad sean de lo mejor.">
    <meta itemprop="image" content="/apuntes/gentoo-en-servidor-instalacion-2014-05/preview.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@guivaloz">
    <meta name="twitter:title" content="Instalación de Gentoo Linux para un servidor">
    <meta name="twitter:description" content="En cantidad de programas y tiempo requerido, instalar un servidor requiere menos de los dos. Pero siempre, gracias a las ventajas de Gentoo Linux, cuidaremos que su desempeño y seguridad sean de lo mejor.">
    <meta name="twitter:image:src" content="/apuntes/gentoo-en-servidor-instalacion-2014-05/preview.jpg">
    <meta property="og:title" content="Instalación de Gentoo Linux para un servidor">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/apuntes/gentoo-en-servidor-instalacion-2014-05/">
    <meta property="og:image" content="/apuntes/gentoo-en-servidor-instalacion-2014-05/preview.jpg">
    <meta property="og:description" content="En cantidad de programas y tiempo requerido, instalar un servidor requiere menos de los dos. Pero siempre, gracias a las ventajas de Gentoo Linux, cuidaremos que su desempeño y seguridad sean de lo mejor.">
    <meta property="og:site_name" content="Movimiento Libre">
    <title>Instalación de Gentoo Linux para un servidor - Movimiento Libre</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" href="/theme/images/icon-hires.png" sizes="192x192">
    <link rel="icon" href="/theme/images/icon-normal.png" sizes="128x128">
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon-76x76.png" sizes="76x76">
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon-120x120.png" sizes="120x120">
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon-152x152.png" sizes="152x152">
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon-180x180.png" sizes="180x180">
    <link rel="alternate" href="/feeds/all.rss.xml" type="application/rss+xml" title="Movimiento Libre Full RSS Feed" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans">
    <link rel="stylesheet" href="/theme/css/movimiento-libre.css">
                    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-74263253-1"></script>
                    <script>
                        window.dataLayer = window.dataLayer || [];
                        function gtag(){dataLayer.push(arguments);}
                        gtag('js', new Date());
                        gtag('config', 'UA-74263253-1');
                    </script>
</head>
<body>
    <nav class="navbar navbar-expand-md navbar-light fixed-top" id="mainNav">
        <div class="container">
            <a class="navbar-brand" href="/">Movimiento Libre</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navBootstrap4" aria-controls="navBootstrap4" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navBootstrap4">
                <ul class="navbar-nav mr-auto">
                    <li><a class="nav-link" href="/category/apuntes.html">Apuntes</a></li>
                    <li><a class="nav-link" href="/category/articulos.html">Artículos</a></li>
                    <li><a class="nav-link" href="/category/presentaciones.html">Presentaciones</a></li>
                    <li><a class="nav-link" href="/portafolio/contacto/index.html">Contacto</a></li>
                </ul>
                <ul class="navbar-nav movimientolibre-navbar-icons">
                    <li><a class="movimientolibre-navbar-icon-link" href="https://twitter.com/guivaloz/" target="_blank"><i class="fab fa-twitter-square"></i></a></li>
                    <li><a class="movimientolibre-navbar-icon-link" href="https://www.facebook.com/movimientolibrepuntocom/" target="_blank"><i class="fab fa-facebook-square"></i></a></li>
                    <li><a class="movimientolibre-navbar-icon-link" href="https://github.com/guivaloz" target="_blank"><i class="fab fa-github-square"></i></a></li>
                    <li><a class="movimientolibre-navbar-icon-link" href="https://movimientolibre.com/feeds/all.rss.xml"><i class="fa fa-rss-square"></i></a></li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container">
        <header>
            <div class="jumbotron head-welcome" itemscope itemtype="http://schema.org/Organization">
                <h1 class="jumbotron-heading head-site-name" itemprop="name">Movimiento Libre</h1>
                <p class="head-site-description" itemprop="description">Plataforma de divulgación de conocimiento libre por Ing. Guillermo Valdés Lozano (guivaloz)</p>
            </div>
        </header>
        <div class="row">
            <div class="col-sm-8">
                <article class="article-post">
                    <script type="application/ld+json">
                        {
                            "@context": "http://schema.org",
                            "@type": "Article",
                            "publisher": {
                            "@type": "Organization",
                            "name": "Movimiento Libre",
                            "logo": {
                                "@type": "ImageObject",
                                "url": "https://movimientolibre.com/theme/images/movimientolibre.png"
                            },
                            "url": "https://movimientolibre.com"
                        },
                        "author": "Guillermo Valdés Lozano (guivaloz)",
                        "name": "Instalación de Gentoo Linux para un servidor",
                        "headline": "Instalación de Gentoo Linux para un servidor",
                        "description": "En cantidad de programas y tiempo requerido, instalar un servidor requiere menos de los dos. Pero siempre, gracias a las ventajas de Gentoo Linux, cuidaremos que su desempeño y seguridad sean de lo mejor.",
                        "dateCreated": "2014-06-15 08:00:00-05:00",
                        "datePublished": "2014-06-15 08:00:00-05:00",
                        "dateModified": "2014-06-15 08:00:00-05:00",
                        "image": "https://movimientolibre.com/apuntes/gentoo-en-servidor-instalacion-2014-05/preview.jpg",
                        "url": "https://movimientolibre.com/apuntes/gentoo-en-servidor-instalacion-2014-05/"
                        }
                    </script>
                    <h2 class="article-post-title">Instalación de Gentoo Linux para un servidor</h2>
                    <p class="article-post-meta">Guillermo Valdés Lozano (guivaloz)<br>15 junio 2014</p>
<p>Cuando hacemos una instalación de <a href="http://www.gentoo.org">Gentoo Linux</a> en una PC o laptop buscamos tener entorno gráfico y muchos programas; como reproductores multimedia, navegadores de internet, herramientas de desarrollo y hasta una suite de oficina. En cambio, <strong>para un servidor, nos enfocamos en instalar el sistema operativo base y los servicios que vaya otorgar a la red local o al internet.</strong></p>
<p>En cantidad de programas y tiempo requerido, instalar un servidor requiere menos de los dos. Pero siempre, gracias a las ventajas de Gentoo Linux, cuidaremos que su <strong>desempeño</strong> y <strong>seguridad</strong> sean de lo mejor.</p>
<p>En el siguiente apunte listo los pasos que tomé para instalar un <strong>servidor web con Apache/PHP/MySQL/PostgreSQL</strong>. No hago una explicación detallada de cada paso; simplemente enlisto los comandos para instalar.</p>
<p><strong>ADVERTENCIA</strong>: El contenido de esta publicación es sólo un respaldo que puede servirle como base. <strong>Algunos comandos pueden destruir la información de su disco duro</strong>; por lo que el autor NO tiene ninguna responsabilidad en lo que resulte. Lea el manual oficial <a href="http://www.gentoo.org/doc/en/handbook/handbook-amd64.xml">Gentoo Handbook AMD64</a>.</p>
<h3>Construir el Sistema</h3>
<p>La gran flexibilidad de Gentoo Linux nos permite hacer esta "construcción" en un subdirectorio o una partición del disco duro. En contraste, otros sistemas operativos requieren un disco duro dedicado y reiniciar la computadora para ejecutar su asistente de instalación. Dicho de otra manera; puede estar construyendo un nuevo Gentoo Linux en una terminal mientras sigue trabajando/entreteniéndose en otra ventana.</p>
<p>Ya teniendo particionado el disco duro y destinando <strong>/dev/sda5</strong> a la raíz del S.O. Formatee...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">mkfs</span><span class="p">.</span><span class="n">ext4</span> <span class="o">-</span><span class="n">L</span> <span class="n">Servidor201405</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda5</span>
<span class="o">#</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span>
<span class="o">#</span> <span class="n">mount</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda5</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span>
</pre></div>


<p>Previamente he bajado el <em>stage</em> y puesto en <strong>/mnt/tmp</strong>. Desempaque...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">cd</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span>
<span class="o">#</span> <span class="n">tar</span> <span class="n">xvjpf</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">stage3</span><span class="o">-</span><span class="n">amd64</span><span class="o">-</span><span class="mi">20140515</span><span class="p">.</span><span class="n">tar</span><span class="p">.</span><span class="n">bz2</span>
</pre></div>


<p>Monte las particiones lógicas...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">mount</span> <span class="o">-</span><span class="n">t</span> <span class="n">proc</span> <span class="k">none</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">proc</span>
<span class="o">#</span> <span class="n">mount</span> <span class="c1">--rbind /sys /mnt/gentoo/sys</span>
<span class="o">#</span> <span class="n">mount</span> <span class="c1">--rbind /dev /mnt/gentoo/dev</span>
</pre></div>


<p>Tengo una partición dedicada para <strong>/usr/portage</strong> en <strong>/dev/sda6</strong>, así que sólo la monto en <strong>/mnt/gentoo/usr/portage</strong></p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">portage</span>
<span class="o">#</span> <span class="n">mount</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda6</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">portage</span>
</pre></div>


<p>Verifique lo montado...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">mount</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span>
</pre></div>


<p>Copie <strong>resolv.conf</strong></p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">cp</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">resolv</span><span class="p">.</span><span class="n">conf</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span>
</pre></div>


<p>Edite <strong>make.conf</strong></p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">nano</span> <span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">portage</span><span class="o">/</span><span class="n">make</span><span class="p">.</span><span class="n">conf</span>
</pre></div>


<p>Con este contenido...</p>
<div class="highlight"><pre><span></span>#
# /etc/portage/make.conf
#
# Servidor Apache/PHP/PostgreSQL Gentoo Linux
#

#
# Servidor 64 bits GENERICO
#
CFLAGS=&quot;-O2 -pipe&quot;
CXXFLAGS=&quot;<span class="cp">${</span><span class="n">CFLAGS</span><span class="cp">}</span>&quot;
CHOST=&quot;x86_64-pc-linux-gnu&quot;

# Cantidad de compilaciones simultaneas
MAKEOPTS=&quot;-j2&quot;

# Español como lengua
LINGUAS=&quot;es es_MX es_AR es_ES&quot;

# Aceptar todas las licencias
ACCEPT_LICENSE=&quot;*&quot;

#
# USE flags
#
USE=&quot;mmx sse sse2&quot;

# Redes
USE=&quot;<span class="cp">${</span><span class="n">USE</span><span class="cp">}</span> apache2 fuse vhosts&quot;

# Base de datos
USE=&quot;<span class="cp">${</span><span class="n">USE</span><span class="cp">}</span> mysql postgres sqlite&quot;

# Desarrollo
USE=&quot;<span class="cp">${</span><span class="n">USE</span><span class="cp">}</span> git php python ruby&quot;

# Graficos
USE=&quot;<span class="cp">${</span><span class="n">USE</span><span class="cp">}</span> corefonts fontconfig freetype gd gnuplot graphviz imagemagick jpeg png tiff truetype&quot;

# Varios
USE=&quot;<span class="cp">${</span><span class="n">USE</span><span class="cp">}</span> latex&quot;

#
# Portage, esto es para usar otra computadora en la red como proveedor del portage y los paquetes.
# Cambie servidor.dominio.lan por el nombre o dirección IP
#
SERVIDOR_PORTAGE=servidor.dominio.lan
PORTDIR=&quot;/usr/portage&quot;
DISTDIR=&quot;<span class="cp">${</span><span class="n">PORTDIR</span><span class="cp">}</span>/distfiles&quot;
PKGDIR=&quot;<span class="cp">${</span><span class="n">PORTDIR</span><span class="cp">}</span>/packages&quot;
SYNC=rsync://<span class="cp">${</span><span class="n">SERVIDOR_PORTAGE</span><span class="cp">}</span>/gentoo-portage
FETCHCOMMAND=&quot;rsync rsync://<span class="cp">${</span><span class="n">SERVIDOR_PORTAGE</span><span class="cp">}</span>/gentoo-distfiles/\<span class="cp">${</span><span class="n">FILE</span><span class="cp">}</span> <span class="cp">${</span><span class="n">DISTDIR</span><span class="cp">}</span>&quot;
</pre></div>


<p>Configure <strong>locale.gen</strong></p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">nano</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">locale</span><span class="p">.</span><span class="n">gen</span>
</pre></div>


<p>Con este contenido...</p>
<div class="highlight"><pre><span></span><span class="n">en_US</span><span class="w"> </span><span class="n">ISO</span><span class="o">-</span><span class="mi">8859</span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="n">en_US</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span><span class="w"> </span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span><span class="w"></span>
<span class="n">es_ES</span><span class="w"> </span><span class="n">ISO</span><span class="o">-</span><span class="mi">8859</span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="n">es_ES</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span><span class="w"> </span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span><span class="w"></span>
<span class="n">es_ES</span><span class="nv">@euro</span><span class="w"> </span><span class="n">ISO</span><span class="o">-</span><span class="mi">8859</span><span class="o">-</span><span class="mi">15</span><span class="w"></span>
<span class="n">es_MX</span><span class="w"> </span><span class="n">ISO</span><span class="o">-</span><span class="mi">8859</span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="n">es_MX</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span><span class="w"> </span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span><span class="w"></span>
</pre></div>


<p>Configure <strong>02locales</strong></p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">nano</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">env</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="mi">02</span><span class="n">locales</span>
</pre></div>


<p>Con este contenido...</p>
<div class="highlight"><pre><span></span><span class="o">#</span>
<span class="o">#</span> <span class="mi">02</span><span class="n">locales</span>
<span class="o">#</span>
<span class="n">LANG</span><span class="o">=</span><span class="ss">&quot;es_MX.UTF-8&quot;</span>
<span class="k">LANGUAGE</span><span class="o">=</span><span class="ss">&quot;es_MX.UTF-8&quot;</span>
<span class="n">LC_ALL</span><span class="o">=</span><span class="ss">&quot;es_MX.UTF-8&quot;</span>
</pre></div>


<p>Haga el <em>chroot</em>:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">chroot</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span> <span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="o">#</span> <span class="n">env</span><span class="o">-</span><span class="k">update</span>
<span class="o">#</span> <span class="k">source</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span>
<span class="o">#</span> <span class="n">export</span> <span class="n">PS1</span><span class="o">=</span><span class="ss">&quot;(nuevo) $PS1&quot;</span>
</pre></div>


<p>Ejecute...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">locale</span><span class="o">-</span><span class="n">gen</span>
</pre></div>


<p>Salga del <em>chroot</em> y vuelva a entrar con los comandos anteriores; así nos aseguramos que se carguen las configuraciones.</p>
<p>Para poder instalar paquetes que están marcados como inestables, hago uso de la reciente característica de Gentoo para desenmascarar paquetes con archivos individuales:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">portage</span><span class="o">/</span><span class="n">package</span><span class="p">.</span><span class="n">keywords</span>
<span class="o">#</span> <span class="n">echo</span> <span class="ss">&quot;dev-ruby/kramdown&quot;</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">portage</span><span class="o">/</span><span class="n">package</span><span class="p">.</span><span class="n">keywords</span><span class="o">/</span><span class="n">dev</span><span class="o">-</span><span class="n">ruby_kramdown</span>
<span class="o">#</span> <span class="n">echo</span> <span class="ss">&quot;sys-fs/ecryptfs-utils&quot;</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">portage</span><span class="o">/</span><span class="n">package</span><span class="p">.</span><span class="n">keywords</span><span class="o">/</span><span class="n">sys</span><span class="o">-</span><span class="n">fs_ecryptfs</span><span class="o">-</span><span class="n">utils</span>
</pre></div>


<p>También para los <em>USE flags</em> se puede hacer lo mismo:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">portage</span><span class="o">/</span><span class="n">package</span><span class="p">.</span><span class="n">use</span>
<span class="o">#</span> <span class="n">echo</span> <span class="ss">&quot;app-text/texlive extra pstricks&quot;</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">portage</span><span class="o">/</span><span class="n">package</span><span class="p">.</span><span class="n">use</span><span class="o">/</span><span class="n">app</span><span class="o">-</span><span class="n">text_texlive</span>
<span class="o">#</span> <span class="n">echo</span> <span class="ss">&quot;net-dns/bind -berkdb -mysql -postgres&quot;</span> <span class="o">&gt;</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">portage</span><span class="o">/</span><span class="n">package</span><span class="p">.</span><span class="n">use</span><span class="o">/</span><span class="n">net</span><span class="o">-</span><span class="n">dns_bind</span>
</pre></div>


<p>Como esta instalación es para un servidor NO cambio el profile, dejo el básico de <strong>AMD64</strong>:</p>
<div class="highlight"><pre><span></span># <span class="nv">eselect</span> <span class="nv">profile</span> <span class="k">show</span>
<span class="nv">Current</span> <span class="o">/</span><span class="nv">etc</span><span class="o">/</span><span class="nv">portage</span><span class="o">/</span><span class="nv">make</span>.<span class="nv">profile</span> <span class="nv">symlink</span>:
<span class="nv">default</span><span class="o">/</span><span class="nv">linux</span><span class="o">/</span><span class="nv">amd64</span><span class="o">/</span><span class="mi">13</span>.<span class="mi">0</span>
</pre></div>


<p>Edite...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">nano</span> <span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">conf</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">keymaps</span>
<span class="o">#</span> <span class="n">nano</span> <span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">hosts</span>
<span class="o">#</span> <span class="n">nano</span> <span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">conf</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">hostname</span>
</pre></div>


<p>Luego defina la zona horaria de su región...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">cp</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">share</span><span class="o">/</span><span class="n">zoneinfo</span><span class="o">/</span><span class="n">Mexico</span><span class="o">/</span><span class="k">General</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="k">localtime</span>
</pre></div>


<p>Instale el <em>kernel</em>. Es largo de explicar, así que sólo diré que debe habilitar los controladores <strong>Virtio</strong> que son los necesarios para <strong>KVM</strong>:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">emerge</span> <span class="n">gentoo</span><span class="o">-</span><span class="n">sources</span>
<span class="o">#</span> <span class="n">cd</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">linux</span>
<span class="o">#</span> <span class="n">make</span> <span class="n">menuconfig</span>
<span class="o">#</span> <span class="n">make</span>
<span class="o">#</span> <span class="n">make</span> <span class="n">modules_install</span>
</pre></div>


<p>Instale unas herramientas básicas...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">emerge</span> <span class="n">gentoolkit</span> <span class="n">reiserfsprogs</span> <span class="n">dhcpcd</span> <span class="n">dosfstools</span> <span class="n">app</span><span class="o">-</span><span class="n">misc</span><span class="o">/</span><span class="n">screen</span> <span class="n">iptables</span> <span class="n">pwgen</span> <span class="n">pciutils</span>
</pre></div>


<p>Instale estos servicios básicos...</p>
<div class="highlight"><pre><span></span># <span class="nv">emerge</span> <span class="nv">acpid</span> <span class="nv">ntp</span> <span class="nv">syslog</span><span class="o">-</span><span class="nv">ng</span> <span class="nv">vixie</span><span class="o">-</span><span class="nv">cron</span> <span class="k">logrotate</span>
# <span class="nv">rc</span><span class="o">-</span><span class="nv">update</span> <span class="nv">add</span> <span class="nv">acpid</span> <span class="nv">default</span>
# <span class="nv">rc</span><span class="o">-</span><span class="nv">update</span> <span class="nv">add</span> <span class="nv">syslog</span><span class="o">-</span><span class="nv">ng</span> <span class="nv">default</span>
# <span class="nv">rc</span><span class="o">-</span><span class="nv">update</span> <span class="nv">add</span> <span class="nv">vixie</span><span class="o">-</span><span class="nv">cron</span> <span class="nv">default</span>
# <span class="nv">rc</span><span class="o">-</span><span class="nv">update</span> <span class="nv">add</span> <span class="nv">ntpd</span> <span class="nv">default</span>
</pre></div>


<p>Cambie la contraseña de <em>root</em>:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">passwd</span>
</pre></div>


<p>Instale la base de datos <strong>PostgreSQL</strong>:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">emerge</span> <span class="n">postgresql</span><span class="o">-</span><span class="n">server</span>
</pre></div>


<p>Instale <strong>Ruby</strong> y la gema <strong>RedCloth</strong> que uso para el <a href="http://cms.movimientolibre.com">CMS de Movimiento Libre</a>:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">emerge</span> <span class="n">ruby</span> <span class="n">redcloth</span>
</pre></div>


<p>Instale <strong>MySQL</strong>:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">emerge</span> <span class="n">mysql</span>
</pre></div>


<p>Instale <strong>Apache2</strong>:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">emerge</span> <span class="n">apache</span>
</pre></div>


<p>Instale <strong>PHP</strong>:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">emerge</span> <span class="n">php</span>
</pre></div>


<p>Instale <strong>LaTeX</strong> y la gema de <strong>Ruby</strong> <strong>Kramdown</strong> que también uso en el CMS:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">emerge</span> <span class="n">texlive</span> <span class="n">kramdown</span>
</pre></div>


<p>Instale herramientas gráficas:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">emerge</span> <span class="n">graphviz</span> <span class="n">imagemagick</span> <span class="n">sci</span><span class="o">-</span><span class="n">visualization</span><span class="o">/</span><span class="n">gnuplot</span>
</pre></div>


<p>Instale <strong>Git</strong>:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">emerge</span> <span class="n">git</span>
</pre></div>


<p>Instale software para cifrado de discos:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">emerge</span> <span class="n">ecryptfs</span><span class="o">-</span><span class="n">utils</span> <span class="n">cryptsetup</span>
</pre></div>


<p>Al término de esta construcción, nos salimos del <em>chroot</em> y desmontamos las particiones auxiliares, más NO la raíz.</p>
<div class="highlight"><pre><span></span># <span class="k">exit</span>
# <span class="nv">umount</span> <span class="o">-</span><span class="nv">l</span> <span class="o">/</span><span class="nv">mnt</span><span class="o">/</span><span class="nv">gentoo</span><span class="o">/</span><span class="nv">sys</span>
# <span class="nv">umount</span> <span class="o">-</span><span class="nv">l</span> <span class="o">/</span><span class="nv">mnt</span><span class="o">/</span><span class="nv">gentoo</span><span class="o">/</span><span class="nv">dev</span>
# <span class="nv">umount</span> <span class="o">/</span><span class="nv">mnt</span><span class="o">/</span><span class="nv">gentoo</span><span class="o">/</span><span class="nv">proc</span>
# <span class="nv">umount</span> <span class="o">/</span><span class="nv">mnt</span><span class="o">/</span><span class="nv">gentoo</span><span class="o">/</span><span class="nv">usr</span><span class="o">/</span><span class="nv">portage</span>
</pre></div>


<h2>Preparar la virtualización KVM</h2>
<p>Haciendo una analogía a <a href="https://es.wikipedia.org/wiki/Frankenstein_o_el_moderno_Prometeo">Frankestein</a>, ya tenemos listo el <em>cerebro</em> ahora vamos a preparar un <em>cuerpo</em>: Usando <a href="http://www.linux-kvm.org/page/Main_Page">KVM</a> cree una nueva virtualización con un disco duro virtual de 24,576 MB (o sea, 24 GB) y arranque con el ISO de Gentoo.</p>
<p>Particione a su gusto con:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">fdisk</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda</span>
</pre></div>


<p>Formatee la partición que va ser la raíz, en mi ejemplo es la <strong>/dev/vda6</strong></p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">mkfs</span><span class="p">.</span><span class="n">ext4</span> <span class="o">-</span><span class="n">L</span> <span class="n">Gentoo</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda6</span>
</pre></div>


<p>Monte la raíz:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">mount</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda6</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span>
</pre></div>


<p>Cambie la contraseña root e inicie el <em>daemon</em> OpenSSH...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">passwd</span>
<span class="o">#</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">sshd</span> <span class="k">start</span>
</pre></div>


<h3>Copiar todo a la virtualización</h3>
<p>Estos comandos los ejecuto en mi Gentoo Linux que tengo de base.</p>
<p>En mi caso tengo KVM con un bridge con red <strong>172.16.71.0/24</strong> y he configurado una dirección IP en la virtualización con <strong>172.16.71.11</strong>. Copie TODO a una sola partición de destino con un comando como éste:</p>
<div class="highlight"><pre><span></span><span class="cp"># cd /mnt/gentoo</span>
<span class="cp"># tar -cvf - . | ssh root@172.16.71.11 tar -C /mnt/gentoo/ -xf -</span>
</pre></div>


<h3>O tener directorios en otras particiones de la virtualización</h3>
<p>Se vale omitir uno o más directorios para después montar otra partición en la virtualización. Por ejemplo, para mantener <strong>/var</strong> en otra partición, primero copiaría TODO menos <strong>/var</strong> con:</p>
<div class="highlight"><pre><span></span><span class="cp"># tar -cvf - --exclude=/var . | ssh root@172.16.71.11 tar -C /mnt/gentoo/ -xf -</span>
</pre></div>


<p>Luego, en la virtualización ejecuto estos comandos, en mi ejemplo <strong>/var</strong> será <strong>/dev/vda7</strong></p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">mkfs</span><span class="p">.</span><span class="n">ext4</span> <span class="o">-</span><span class="n">L</span> <span class="n">Var</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda7</span>
<span class="o">#</span> <span class="n">mkdir</span> <span class="o">/</span><span class="n">var</span>
<span class="o">#</span> <span class="n">mount</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda7</span> <span class="o">/</span><span class="n">var</span>
</pre></div>


<p>Regreso al sistema Gentoo Linux base y mando copia del directorio <strong>/var</strong> y su contenido</p>
<div class="highlight"><pre><span></span><span class="cp"># cd /mnt/gentoo/var</span>
<span class="cp"># tar -cvf - . | ssh root@172.16.71.11 tar -C /mnt/gentoo/var/ -xf -</span>
</pre></div>


<h3>De regreso a la virtualización</h3>
<p>Monte...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">mount</span> <span class="o">-</span><span class="n">t</span> <span class="n">proc</span> <span class="k">none</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">proc</span>
<span class="o">#</span> <span class="n">mount</span> <span class="o">-</span><span class="n">o</span> <span class="n">bind</span> <span class="o">/</span><span class="n">dev</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">dev</span>
<span class="o">#</span> <span class="n">mount</span> <span class="o">-</span><span class="n">o</span> <span class="n">bind</span> <span class="o">/</span><span class="n">sys</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">sys</span>
</pre></div>


<p><em>Formatee</em> las otras particiones...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">mkfs</span><span class="p">.</span><span class="n">ext2</span> <span class="o">-</span><span class="n">L</span> <span class="n">Boot</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda1</span>
<span class="o">#</span> <span class="n">mkfs</span><span class="p">.</span><span class="n">ext4</span> <span class="o">-</span><span class="n">L</span> <span class="n">Home</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda2</span>
<span class="o">#</span> <span class="n">mkfs</span><span class="p">.</span><span class="n">ext4</span> <span class="o">-</span><span class="n">L</span> <span class="n">Portage</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda3</span>
</pre></div>


<p>Monte...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">mount</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda1</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">boot</span>
<span class="o">#</span> <span class="n">mount</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda3</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">portage</span>
<span class="o">#</span> <span class="n">mkswap</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda5</span>
<span class="o">#</span> <span class="n">swapon</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda5</span>
</pre></div>


<p>Sincronize el <em>portage</em>, en mi caso tengo un equipo con <em>rsyncd</em> andando...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">cd</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">portage</span>
<span class="o">#</span> <span class="n">rsync</span> <span class="o">-</span><span class="n">av</span> <span class="n">rsync</span><span class="p">:</span><span class="o">//</span><span class="n">servidorlocal</span><span class="o">/</span><span class="n">gentoo</span><span class="o">-</span><span class="n">portage</span><span class="cm">/* .</span>
</pre></div>


<p>Haga el <em>chroot</em>...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">cp</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">resolv</span><span class="p">.</span><span class="n">conf</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span>
<span class="o">#</span> <span class="n">chroot</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span> <span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="o">#</span> <span class="k">source</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">profile</span>
<span class="o">#</span> <span class="n">export</span> <span class="n">PS1</span><span class="o">=</span><span class="ss">&quot;(nuevo) $PS1&quot;</span>
</pre></div>


<p>Edite <strong>fstab</strong></p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">nano</span> <span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">fstab</span>
</pre></div>


<p>Esta es una sugerencia de su contenido, va de acuerdo a como haya particionado...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="o">&lt;</span><span class="n">fs</span><span class="o">&gt;</span>       <span class="o">&lt;</span><span class="n">mountpoint</span><span class="o">&gt;</span>    <span class="o">&lt;</span><span class="k">type</span><span class="o">&gt;</span>    <span class="o">&lt;</span><span class="n">opts</span><span class="o">&gt;</span>            <span class="o">&lt;</span><span class="n">dump</span><span class="o">/</span><span class="n">pass</span><span class="o">&gt;</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda1</span>    <span class="o">/</span><span class="n">boot</span>           <span class="n">ext2</span>      <span class="n">noauto</span><span class="p">,</span><span class="n">noatime</span>    <span class="mi">1</span> <span class="mi">2</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda2</span>    <span class="o">/</span><span class="n">home</span>           <span class="n">ext4</span>      <span class="k">defaults</span>          <span class="mi">0</span> <span class="mi">1</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda3</span>    <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">portage</span>    <span class="n">ext4</span>      <span class="k">defaults</span>          <span class="mi">0</span> <span class="mi">0</span>
<span class="o">#####</span>  <span class="n">EXTENDED</span>  <span class="o">#####</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda5</span>    <span class="k">none</span>            <span class="n">swap</span>      <span class="n">sw</span>                <span class="mi">0</span> <span class="mi">0</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda6</span>    <span class="o">/</span>               <span class="n">ext4</span>      <span class="k">defaults</span>          <span class="mi">0</span> <span class="mi">1</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda7</span>    <span class="o">/</span><span class="n">var</span>            <span class="n">ext4</span>      <span class="n">noatime</span>           <span class="mi">0</span> <span class="mi">0</span>
</pre></div>


<p>Instale el <em>kernel</em>...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">cd</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">src</span><span class="o">/</span><span class="n">linux</span>
<span class="o">#</span> <span class="n">make</span> <span class="n">install</span>
</pre></div>


<p>Instale <strong>GRUB</strong>:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">emerge</span> <span class="o">-</span><span class="n">pv</span> <span class="n">grub</span>
<span class="o">#</span> <span class="n">emerge</span> <span class="n">grub</span>
<span class="o">#</span> <span class="n">grub2</span><span class="o">-</span><span class="n">install</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda</span>
</pre></div>


<p>Configure <strong>GRUB</strong>:</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="k">default</span>
<span class="o">#</span> <span class="n">nano</span> <span class="n">grub</span>
<span class="o">#</span> <span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">grub</span><span class="p">.</span><span class="n">d</span>
<span class="o">#</span> <span class="n">nano</span> <span class="mi">40</span><span class="n">_custom</span>
</pre></div>


<p>En <strong>40_custom</strong> escriba la ruta correcta al kernel que haya instalado...</p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="ch">#!/bin/sh</span>
<span class="nb">exec</span> tail -n +3 <span class="nv">$0</span>
<span class="c1"># This file provides an easy way to add custom menu entries.  Simply type the</span>
<span class="c1"># menu entries you want to add after this comment.  Be careful not to change</span>
<span class="c1"># the &#39;exec tail&#39; line above.</span>

<span class="c1">#</span>
<span class="c1"># Gentoo Linux</span>
<span class="c1">#</span>
menuentry <span class="s1">&#39;Gentoo Linux 2014-05-26 vda6 kernel 3.12.13&#39;</span> <span class="o">{</span>
    linux /vmlinuz-3.12.13-gentoo <span class="nv">root</span><span class="o">=</span>/dev/vda6 <span class="nv">resume</span><span class="o">=</span>/dev/vda5
<span class="o">}</span>
</pre></div>
</td></tr></table>

<p>Luego, pida a <strong>GRUB</strong> que haga la configuración...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">grub2</span><span class="o">-</span><span class="n">mkconfig</span> <span class="o">-</span><span class="n">o</span> <span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">grub</span><span class="o">/</span><span class="n">grub</span><span class="p">.</span><span class="n">cfg</span>
</pre></div>


<p>Programe que el <em>daemon</em> <strong>OpenSSH</strong> se inicie al encender...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">sshd</span> <span class="k">start</span>
<span class="o">#</span> <span class="n">rc</span><span class="o">-</span><span class="k">update</span> <span class="k">add</span> <span class="n">sshd</span> <span class="k">default</span>
</pre></div>


<p>Ponga la contraseña de <em>root</em>...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">passwd</span>
</pre></div>


<p>Desmonte las particiones...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">umount</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">boot</span>
<span class="o">#</span> <span class="n">umount</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">portage</span>
<span class="o">#</span> <span class="n">umount</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">var</span>
<span class="o">#</span> <span class="n">umount</span> <span class="o">-</span><span class="n">l</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">sys</span>
<span class="o">#</span> <span class="n">umount</span> <span class="o">-</span><span class="n">l</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">dev</span>
<span class="o">#</span> <span class="n">umount</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">proc</span>
<span class="o">#</span> <span class="n">umount</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span>
</pre></div>


<p>Apague y pruebe...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">halt</span>
</pre></div>


<h3>Consola Serial</h3>
<p>Usar una consola serial libera al virtualizador de tener simpre andando una interfaz gráfica para el huésped.</p>
<p>Respalde y edite <strong>inittab</strong>...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">cd</span> <span class="o">/</span><span class="n">etc</span>
<span class="o">#</span> <span class="n">cp</span> <span class="n">inittab</span> <span class="n">inittab</span><span class="p">.</span><span class="n">backup</span>
<span class="o">#</span> <span class="n">nano</span> <span class="n">inittab</span>
</pre></div>


<p>Cambie estas líneas...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="nb">SERIAL</span> <span class="n">CONSOLES</span>
<span class="n">s0</span><span class="p">:</span><span class="mi">12345</span><span class="p">:</span><span class="n">respawn</span><span class="p">:</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">agetty</span> <span class="o">-</span><span class="n">L</span> <span class="o">-</span><span class="n">f</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">issue</span><span class="p">.</span><span class="n">logo</span> <span class="mi">9600</span> <span class="n">ttyS0</span> <span class="n">vt100</span>
<span class="n">s1</span><span class="p">:</span><span class="mi">12345</span><span class="p">:</span><span class="n">respawn</span><span class="p">:</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">agetty</span> <span class="o">-</span><span class="n">L</span> <span class="o">-</span><span class="n">f</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">issue</span><span class="p">.</span><span class="n">logo</span> <span class="mi">38400</span> <span class="n">ttyS1</span> <span class="n">vt100</span>
</pre></div>


<p>Modifique <strong>GRUB</strong>...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">cd</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="k">default</span><span class="o">/</span>
<span class="o">#</span> <span class="n">nano</span> <span class="n">grub</span>
</pre></div>


<p>Haga que estas líneas tengan esto...</p>
<div class="highlight"><pre><span></span># <span class="nv">Append</span> <span class="nv">parameters</span> <span class="nv">to</span> <span class="nv">the</span> <span class="nv">linux</span> <span class="nv">kernel</span> <span class="nv">command</span> <span class="nv">line</span>
<span class="nv">GRUB_CMDLINE_LINUX</span><span class="o">=</span><span class="s2">&quot;</span><span class="s">console=ttyS1,38400</span><span class="s2">&quot;</span>

# <span class="nv">Append</span> <span class="nv">parameters</span> <span class="nv">to</span> <span class="nv">the</span> <span class="nv">linux</span> <span class="nv">kernel</span> <span class="nv">command</span> <span class="nv">line</span> <span class="k">for</span> <span class="nv">non</span><span class="o">-</span><span class="nv">recovery</span> <span class="nv">entries</span>
#<span class="nv">GRUB_CMDLINE_LINUX_DEFAULT</span><span class="o">=</span><span class="s2">&quot;&quot;</span>

# <span class="nv">Uncomment</span> <span class="nv">to</span> <span class="nv">disable</span> <span class="nv">graphical</span> <span class="nv">terminal</span> <span class="ss">(</span><span class="nv">grub</span><span class="o">-</span><span class="nv">pc</span> <span class="nv">only</span><span class="ss">)</span>
<span class="nv">GRUB_TERMINAL</span><span class="o">=</span><span class="nv">console</span>
</pre></div>


<p>También cambie configuración del <strong>GRUB</strong> para la carga del kernel...</p>
<div class="highlight"><pre><span></span><span class="o">#</span> <span class="n">cd</span> <span class="p">..</span><span class="o">/</span><span class="n">grub</span><span class="p">.</span><span class="n">d</span>
<span class="o">#</span> <span class="n">nano</span> <span class="mi">40</span><span class="n">_custom</span>
</pre></div>


<p>Agregue <strong>console=ttyS1,38400</strong> al final de la instrucción...</p>
<div class="highlight"><pre><span></span><span class="o">#</span>
<span class="o">#</span> <span class="n">Gentoo</span> <span class="n">Linux</span>
<span class="o">#</span>
<span class="n">menuentry</span> <span class="s1">&#39;Gentoo Linux 2014-05-26 vda6 kernel 3.12.13&#39;</span> <span class="err">{</span>
        <span class="n">linux</span> <span class="o">/</span><span class="n">vmlinuz</span><span class="o">-</span><span class="mi">3</span><span class="p">.</span><span class="mi">12</span><span class="p">.</span><span class="mi">13</span><span class="o">-</span><span class="n">gentoo</span> <span class="n">root</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda6</span> <span class="n">resume</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">vda5</span> <span class="n">console</span><span class="o">=</span><span class="n">ttyS1</span><span class="p">,</span><span class="mi">38400</span>
<span class="err">}</span>
</pre></div>


<p>Apague la máquina virtual. En la configuración de la virtualización retire el monitor, el ratón, el dispositivo <em>spice</em> si lo hubiera y arranque de nuevo.</p>
                </article>
            </div>
            <div class="col-sm-4">
                <aside>
                    <div class="card my-4 movimientolibre-card aside-about">
                        <h5 class="card-header movimientolibre-card-header">A cerca de</h5>
                        <div class="card-body">
                            <p class="card-text">
                                Este es un sitio web que busca divulgar
                                conocimiento y promover el uso de software libre.
                                Su creador es reconocido como desarrollador que
                                fabrica estas herramientas tanto para entidades
                                públicas como privadas.
                                Conozca el portafolio:
                            </p>
                        </div>
                        <ul class="list-group list-group-flush">
                            <li class="list-group-item movimientolibre-list-group-item"><a class="card-link" href="/portafolio/soluciones/">Soluciones en software a la medida</a></li>
                        </ul>
                    </div>
                    <div class="card my-4 movimientolibre-card">
                        <h5 class="card-header movimientolibre-card-header">Etiquetas</h5>
                        <div class="card-body">
                            <ul class="list-unstyled mb-0">
                                <li><a href="/tag/astronomia.html">astronomía</a></li>
                                <li><a href="/tag/ciencia-de-datos.html">ciencia de datos</a></li>
                                <li><a href="/tag/conferencias.html">conferencias</a></li>
                                <li><a href="/tag/desarrollo.html">desarrollo</a></li>
                                <li><a href="/tag/docker.html">docker</a></li>
                                <li><a href="/tag/educacion.html">educación</a></li>
                                <li><a href="/tag/fedora.html">fedora</a></li>
                                <li><a href="/tag/flisol.html">flisol</a></li>
                                <li><a href="/tag/gentoo-linux.html">gentoo linux</a></li>
                                <li><a href="/tag/git.html">git</a></li>
                                <li><a href="/tag/gnu-linux.html">gnu linux</a></li>
                                <li><a href="/tag/gulag.html">gulag</a></li>
                                <li><a href="/tag/hardware.html">hardware</a></li>
                                <li><a href="/tag/kde.html">kde</a></li>
                                <li><a href="/tag/kernel-linux.html">kernel linux</a></li>
                                <li><a href="/tag/latex.html">latex</a></li>
                                <li><a href="/tag/markdown.html">markdown</a></li>
                                <li><a href="/tag/php.html">php</a></li>
                                <li><a href="/tag/politica.html">política</a></li>
                                <li><a href="/tag/postgresql.html">postgresql</a></li>
                                <li><a href="/tag/ruby.html">ruby</a></li>
                                <li><a href="/tag/servidores.html">servidores</a></li>
                                <li><a href="/tag/software-libre.html">software libre</a></li>
                                <li><a href="/tag/vida-cotidiana.html">vida cotidiana</a></li>
                                <li><a href="/tag/wallpapers.html">wallpapers</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="card my-4 movimientolibre-card">
                        <h5 class="card-header movimientolibre-card-header">Buscar</h5>
                        <div class="card-body">
                    <script>
                        (function() {
                            var cx = '015464194519155410478:jqayrodgycs';
                            var gcse = document.createElement('script');
                            gcse.type = 'text/javascript';
                            gcse.async = true;
                            gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                            var s = document.getElementsByTagName('script')[0];
                            s.parentNode.insertBefore(gcse, s);
                        })();
                    </script>
                    <gcse:search></gcse:search>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </div>
    <footer class="text-muted">
        <div class="container">
            <hr>
            <p>
                Copyright &copy; 2006-2019 Guillermo Valdés Lozano.
                Protegidos por la licencia <a href="/licencias/gfdl-es/">GFDL</a>.
                Se otorga permiso para copiar, distribuir y/o modificar estos documentos.
                Sitio web elaborado con <a href="https://blog.getpelican.com/">Pelican</a> que es programado en <a href="https://python.org/">Python</a>; el código fuente está en <a href="https://github.com/MovimientoLibre/plataforma.web">GitHub</a> protegido por la licencia <a href="/licencias/gpl-2-es/">GPLv3</a>.
            </p>
        </div>
    </footer>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
    <script src="/theme/js/movimiento-libre.js"></script>
</body>
</html>
