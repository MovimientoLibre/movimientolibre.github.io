<!doctype html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="generator" content="Pelican Static Site Generator, Powered by Python">
    <meta name="description" content="Explico una forma alternativa de instalar Gentoo Linux. No es por medio de un asistente ni del LiveCD, sino por gran cantidad de comandos que nos brindarán gran flexibilidad.">
    <meta name="keywords" content="gentoo linux, apuntes">
    <meta name="author" content="Guillermo Valdés Lozano (guivaloz)">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@guivaloz">
    <meta name="twitter:title" content="Mi instalación personal de Gentoo Linux, primera parte (actualizado 2008-nov)">
    <meta name="twitter:description" content="Explico una forma alternativa de instalar Gentoo Linux. No es por medio de un asistente ni del LiveCD, sino por gran cantidad de comandos que nos brindarán gran flexibilidad.">
    <meta name="twitter:image:src" content="/apuntes/gentoo-linux-mi-instalacion-personal-1/preview.jpg">
    <meta property="og:title" content="Mi instalación personal de Gentoo Linux, primera parte (actualizado 2008-nov)">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/apuntes/gentoo-linux-mi-instalacion-personal-1/">
    <meta property="og:image" content="/apuntes/gentoo-linux-mi-instalacion-personal-1/preview.jpg">
    <meta property="og:description" content="Explico una forma alternativa de instalar Gentoo Linux. No es por medio de un asistente ni del LiveCD, sino por gran cantidad de comandos que nos brindarán gran flexibilidad.">
    <meta property="og:site_name" content="Movimiento Libre">
    <title>Mi instalación personal de Gentoo Linux, primera parte (actualizado 2008-nov) - Movimiento Libre</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    <link rel="icon" href="/theme/images/icon-hires.png" sizes="192x192">
    <link rel="icon" href="/theme/images/icon-normal.png" sizes="128x128">
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon-76x76.png" sizes="76x76">
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon-120x120.png" sizes="120x120">
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon-152x152.png" sizes="152x152">
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon-180x180.png" sizes="180x180">
    <link rel="alternate" href="/feeds/all.rss.xml" type="application/rss+xml" title="Movimiento Libre Full RSS Feed" />
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css" integrity="sha384-GJzZqFGwb1QTTN6wy59ffF1BuGJpLSa9DkKMp0DgiMDm4iYMj70gZWKYbI706tWS" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" integrity="sha384-fnmOCqbTlWIlj8LyTjo7mOUStjsKC4pOpQbqyi7RrhN7udi9RwhKkMHpvLbHG9Sr" crossorigin="anonymous">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans&display=swap">
    <link rel="stylesheet" href="/theme/css/movimiento-libre.css">
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-74263253-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-74263253-1');
    </script>
</head>
<body>
    <nav class="navbar navbar-expand-md navbar-light fixed-top" id="mainNav">
        <div class="container">
            <a class="navbar-brand" href="/">Movimiento Libre</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navBootstrap4" aria-controls="navBootstrap4" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navBootstrap4">
                <ul class="navbar-nav mr-auto">
                    <li><a class="nav-link" href="/category/apuntes.html">Apuntes</a></li>
                    <li><a class="nav-link" href="/category/articulos.html">Artículos</a></li>
                    <li><a class="nav-link" href="/category/presentaciones.html">Presentaciones</a></li>
                    <li><a class="nav-link" href="/portafolio/contacto/index.html">Contacto</a></li>
                </ul>
                <ul class="navbar-nav movimientolibre-navbar-icons">
                    <li><a class="movimientolibre-navbar-icon-link" href="https://twitter.com/guivaloz/" target="_blank"><i class="fab fa-twitter-square"></i></a></li>
                    <li><a class="movimientolibre-navbar-icon-link" href="https://www.facebook.com/movimientolibrepuntocom/" target="_blank"><i class="fab fa-facebook-square"></i></a></li>
                    <li><a class="movimientolibre-navbar-icon-link" href="https://github.com/guivaloz" target="_blank"><i class="fab fa-github-square"></i></a></li>
                    <li><a class="movimientolibre-navbar-icon-link" href="https://movimientolibre.com/feeds/all.rss.xml"><i class="fa fa-rss-square"></i></a></li>
                </ul>
            </div>
        </div>
    </nav>
    <div class="container">
        <header>
            <div class="jumbotron head-welcome" itemscope itemtype="http://schema.org/Organization">
                <h1 class="jumbotron-heading head-site-name" itemprop="name">Movimiento Libre</h1>
                <p class="head-site-description" itemprop="description">Plataforma de divulgación de conocimiento libre por Ing. Guillermo Valdés Lozano (guivaloz)</p>
            </div>
        </header>
        <div class="row">
            <div class="col-sm-8">
                <article class="article-post">
                    <script type="application/ld+json">
                        {
                            "@context": "http://schema.org",
                            "@type": "Article",
                            "publisher": {
                            "@type": "Organization",
                            "name": "Movimiento Libre",
                            "logo": {
                                "@type": "ImageObject",
                                "url": "https://movimientolibre.com/theme/images/movimientolibre.png"
                            },
                            "url": "https://movimientolibre.com"
                        },
                        "author": "Guillermo Valdés Lozano (guivaloz)",
                        "name": "Mi instalación personal de Gentoo Linux, primera parte (actualizado 2008-nov)",
                        "headline": "Mi instalación personal de Gentoo Linux, primera parte (actualizado 2008-nov)",
                        "description": "Explico una forma alternativa de instalar Gentoo Linux. No es por medio de un asistente ni del LiveCD, sino por gran cantidad de comandos que nos brindarán gran flexibilidad.",
                        "dateCreated": "2008-11-15 21:00:00-06:00",
                        "datePublished": "2008-11-15 21:00:00-06:00",
                        "dateModified": "2008-11-15 21:00:00-06:00",
                        "image": "https://movimientolibre.com/apuntes/gentoo-linux-mi-instalacion-personal-1/preview.jpg",
                        "url": "https://movimientolibre.com/apuntes/gentoo-linux-mi-instalacion-personal-1/"
                        }
                    </script>
                    <h2 class="article-post-title">Mi instalación personal de Gentoo Linux, primera parte (actualizado 2008-nov)</h2>
                    <p class="article-post-meta">Guillermo Valdés Lozano (guivaloz)<br>15 noviembre 2008</p>
<p>Hace algunos días actualicé el <a href="http://es.wikipedia.org/wiki/Portage">Portage</a> de la instalación de <a href="http://www.gentoo.org/">Gentoo Linux</a> que tengo en mi portátil, una Dell Inspiron 9300. Observé que la versión estable del KDE había cambiado a la 3.5.8 y sentí un <em>enfermizo cosquilleo</em>... NO me daban ganas de actualizar... sino de iniciar una NUEVA instalación en este equipo.</p>
<p>De forma habitual, después de actualizar el <em>portage</em> podemos solicitar un listado de los paquetes que se pueden actualizar (valga la redundancia). Gentoo Linux se distingue por bajar el código fuente, desempacarlo, compilarlo e instalarlo; lo cual consume más tiempo que las otras formas de actualización de las demás distribuciones.</p>
<p>Los paquetes pequeños suelen tomar algunos minutos en actualizarse. Pero la actualización de un paquete grande (como Mozilla Firefox o KOffice) o de un entorno gráfico sofisticado (como Gnome o KDE) puede tomar varias horas.</p>
<p>Uno de los atractivos de hacer una nueva instalación es que podemos probar nuevos parámetros de compilación. En esta ocasión me atrae la idea de <strong>desactivar arts</strong> (es el controlador de audio por defecto de KDE 3.x, no funciona tan bien como quisiera y <a href="http://multimedia.kde.org/">será depreciado con el KDE 4</a>) y <strong>activar ipv6</strong> (aunque no me he conectado aún a una red de éstas, tal vez no falte mucho para que lo tenga que hacer).</p>
<p>Le advierto que la instalación de un Gentoo Linux con un entorno gráfico (Gnome o KDE) y decenas de aplicaciones son <strong>muchas horas</strong> de descarga, compilación, instalación y configuración. Vea el lado positivo, será <em>divertido</em>, aprenderá mucho y estará optimizando las aplicaciones a la medida de su equipo. <strong>Pues ¡SI!... me confieso adicto... a tener mi GNU/Linux optimizado y al día.</strong></p>
<p>A continuación explico <em>una forma alternativa</em> de instalar Gentoo Linux. No es por medio de un asistente ni del LiveCD, sino por gran cantidad de comandos que nos brindarán gran flexibilidad.</p>
<p>También aprovecho que ya tengo particionado el disco duro e instalado Gentoo Linux en este equipo. Gracias a esto, es posible estar instalando Gentoo Linux en una partición mientras se sigue trabajando en la instalación anterior, por que todo esto lo puede hacer en una terminal.</p>
<p><img class="img-fluid" src="kcmsystem.png"></p>
<p><strong>ADVERTENCIA:</strong> Esta guía va dirigida a usuarios con experiencia en GNU/Linux. <em>Los comandos mostrados aquí podrían borrar irrevesiblemente sus archivos.</em> Por lo que le sugiero que, <em>antes que nada, haga un respaldo de todo lo que considere importante</em>. No ofrezco ningua garantía ni atenderé ningún reclamo de los resultados que pudieran ocurrir.</p>
<p><img class="img-fluid" src="kate.png"></p>
<h3>Sobre este manual</h3>
<ul>
<li>Este manual describe los pasos para instalar Gentoo Linux hasta llegar a tener un entorno de escritorio KDE con los paquetes preferidos del autor. Me inclino por el desarrollo de aplicaciones web, por lo que instalaré Apache, PostgreSQL y PHP.</li>
<li>No describo ampliamente las cualidades de los paquetes. Me he enfocado en hacer una guía <em>paso a paso</em>, comando a comando que les mostrará cómo es Gentoo Linux. Si tiene dudas sobre algún paquete, no dude en consultar al <a href="https://wiki.gentoo.org/">Gentoo Wiki</a> y a <em>Don</em> <a href="http://www.google.com/">Google</a>.</li>
<li>En Gentoo Linux es posible tener varias instalaciones de esta distribución en el mismo equipo. Lo cual aprovecho usando la instalación anterior y haciendo todo desde una consola. No es necesario insertar el CD de instalación.</li>
<li>El <em>portage</em> /usr/portage/ así como las fuentes descargadas (almacenadas en /usr/portage/distfiles/) las tengo en una partición dedicada. Lo cual me permite compartirlo con las varias instalaciones en el mismo equipo.</li>
<li>Los comandos que deben ser ingresados como <em>root</em> tienen un "#" al principio, en cambio, los ingresados en una cuenta de usuario tienen "$" al inicio. Tenga la precaución de no confundir el contenido de los archivos de configuración, porque suelen usar "#" para los comentarios.</li>
<li>En la primera parte (esta página) llegaré a tener un sistema básico que llegue a consola.</li>
<li>En la <a href="gentoo-linux-mi-instalacion-personal-2.html">segunda parte</a> tendré instalado la base del entorno de escritorio <strong>KDE</strong>.</li>
<li>En la <a href="gentoo-linux-mi-instalacion-personal-3.html">tercera parte</a> instalaré mis paquetes preferidos.</li>
</ul>
<p><img class="img-fluid" src="kcmpartitions.png"></p>
<h3>Mis particiones</h3>
<p>En mi computadora portátil tengo un modesto disco duro de 60 GB. El archivo <em>/etc/fstab</em> (de mi nueva instalación) tiene este contenido:</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span>
<span class="err"># /etc/fstab</span>
<span class="err">#</span>
<span class="err"># &lt;fs&gt;       &lt;mountpoint&gt;     &lt;type&gt;      &lt;opts&gt;      &lt;dump/pass&gt;</span>
<span class="err">/dev/sda1    /boot            ext2        noauto      1 2</span>
<span class="err">/dev/sda2    /home            ext3        defaults    0 0</span>
<span class="err">/dev/sda3    /usr/portage     reiserfs    defaults    0 0</span>
<span class="err"># La particion /dev/sda4 es EXTENDED</span>
<span class="err">/dev/sda5    none             swap        sw          0 0</span>
<span class="err">/dev/sda6    /                ext3        noatime     0 1</span>
<span class="err">/dev/sda7    /mnt/anterior    ext3        noauto      0 0</span>
<span class="err">/dev/sda8    /mnt/backup      ext3        defaults    0 0</span>
<span class="err">/dev/sda9    /mnt/archivos    ext3        defaults    0 0</span>
</code></pre></div>


<ul>
<li><em>/boot</em> - 35 MB - Es la partición de arranque que contiene los kernels.</li>
<li><em>/home</em> - 8 GB - Mis archivos (y directorios ocultos con configuraciones personales).</li>
<li><em>/usr/portage</em> - 8 GB - Todo el árbol del <em>portage</em> así como los paquetes fuentes. El hecho de tenerlo en una partición me permite compartirlo con las demás instalaciones de Gentoo Linux que tenga en el equipo.</li>
<li><em>swap</em> - 4 GB - Los datos que no quepan en la RAM pasan a esta <em>memoria virtual</em>. También se usa al suspender a disco. Lea este <a href="http://www.cyberciti.biz/tips/linux-swap-space.html">artículo</a> para saber más sobre el espacio que le convenga para su <em>swap</em>.</li>
<li><em>/ (raíz)</em> - 9 GB - En esta partición instalaré el <em>nuevo</em> Gentoo Linux.</li>
<li><em>/mnt/anterior</em> - 9 GB - El <em>anterior</em> Gentoo Linux. Mientras no pueda arrancar en el <em>nuevo</em> usaré éste.</li>
<li><em>/mnt/backup</em> - 9 GB - Es el respaldo local de mis trabajos más importantes.</li>
<li><em>/mnt/archivos</em> - Lo que resta del disco - Es la partición más grande, dedicada a los videos, la música, libros, etc. En general archivos grandes.</li>
</ul>
<p><img class="img-fluid" src="hdd_unmount.png"></p>
<h3>Formatear y montar la partición raiz de la nueva instalación</h3>
<p>Comienzo por formatear la partición. Cambie <em>sdaX</em> por la partición que corresponda en su equipo (en mi caso es <em>/dev/sda6</em>).</p>
<div class="highlight"><pre><span></span><code><span class="err"># mkfs.ext3 /dev/sdaX</span>
</code></pre></div>


<p>Creo el directorio para montar la partición (si ya lo tiene, omita el paso). Y la montamos.</p>
<div class="highlight"><pre><span></span><code><span class="err"># mkdir /mnt/gentoo</span>
<span class="err"># mount /dev/sdaX /mnt/gentoo</span>
<span class="err"># ls /mnt/gentoo</span>
<span class="err">lost+found</span>
</code></pre></div>


<p><img class="img-fluid" src="tar.png"></p>
<h3>Desempacamos el stage</h3>
<p>Siempre tengo a la mano el último <em>stage</em>. Para el <em>Pentium-M</em> uso el preparado para <em>i686</em>. Puede obtenerlo en <a href="http://gentoo.osuosl.org/releases/x86/current/stages/">gentoo.osuosl.org</a>. Compruebo la integridad del archivo con <em>md5sum</em>.</p>
<div class="highlight"><pre><span></span><code>$ <span class="nb">cd</span> /home/guivaloz/software/gentoo/
$ md5sum -c stage3-i686-2008.0.tar.bz2.DIGESTS
./stage3-i686-2008.0.tar.bz2: La suma coincide
</code></pre></div>


<p>Luego lo desempaco en <em>/mnt/gentoo/</em></p>
<div class="highlight"><pre><span></span><code><span class="err"># cd /mnt/gentoo/</span>
<span class="err"># tar xvjpf /home/guivaloz/software/gentoo/stage3-i686-2008.0.tar.bz2</span>
</code></pre></div>


<p>Antes de comenzar a instalar es muy recomendable actualizar el <em>portage</em> para que todo lo que instalemos sean versiones <em>nuevas</em>.</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge --sync</span>
</code></pre></div>


<p><img class="img-fluid" src="txt.png"></p>
<h3>Configuraciones</h3>
<p>Edito los principales archivos de la configuración de Gentoo Linux.</p>
<p><em>make.conf</em> contiene las opciones de compilación de acuerdo a las características del equipo. Yo prefiero conservar las compilaciones de los paquetes que instalo. Esto me perite <em>compartirlas</em> con otras instalaciones de Gentoo Linux en el mismo equipo y en otros equipos <em>idénticos</em>, siempre y cuando la configuración en <em>make.conf</em> sea igual.</p>
<div class="highlight"><pre><span></span><code># nano -w /mnt/gentoo/etc/make.conf

#
# /etc/make.conf
#
# Dell Inspiron 9300
#

# This should not be changed unless you know exactly what you are doing.  You
# should probably be using a different stage, instead.
CHOST=&quot;i686-pc-linux-gnu&quot;

# Intel(R) Pentium(R) M processor 1.73GHz
#   CPU Family : 6
#   Model      : 13
CFLAGS=&quot;-O2 -march=pentium-m -pipe -fomit-frame-pointer&quot;
CXXFLAGS=&quot;<span class="cp">${</span><span class="n">CFLAGS</span><span class="cp">}</span>&quot;

# Dos compilaciones paralelas
MAKEOPTS=&quot;-j2&quot;

# Conservar compilaciones
FEATURES=&quot;buildpkg fixpackages&quot;
PKGDIR=/usr/portage/packages

# Idioma
LINGUAS=&quot;es&quot;

#
# Variable USE
#
USE=&quot;-kerberos mmx sse sse2&quot;

#
# Servidor de paquetes
#
#PORTDIR=/usr/portage
#DISTDIR=<span class="cp">${</span><span class="n">PORTDIR</span><span class="cp">}</span>/distfiles
#SYNC=rsync://SERVIDOR/gentoo-portage
#FETCHCOMMAND=&quot;rsync rsync://SERVIDOR/gentoo-packages/\<span class="cp">${</span><span class="n">FILE</span><span class="cp">}</span> <span class="cp">${</span><span class="n">DISTDIR</span><span class="cp">}</span>&quot;
</code></pre></div>


<p><em>locale.gen</em> establece los conjuntos de caracteres para la compilación de los paquetes.</p>
<div class="highlight"><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="n">nano</span><span class="w"> </span><span class="o">-</span><span class="n">w</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">locale</span><span class="p">.</span><span class="n">gen</span><span class="w"></span>

<span class="err">#</span><span class="w"></span>
<span class="err">#</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">locale</span><span class="p">.</span><span class="n">gen</span><span class="w"></span>
<span class="err">#</span><span class="w"></span>
<span class="err">#</span><span class="w"> </span><span class="n">EEUU</span><span class="w"></span>
<span class="n">en_US</span><span class="w"> </span><span class="n">ISO</span><span class="o">-</span><span class="mi">8859</span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="n">en_US</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span><span class="w"> </span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span><span class="w"></span>
<span class="err">#</span><span class="w"> </span><span class="n">España</span><span class="w"></span>
<span class="n">es_ES</span><span class="w"> </span><span class="n">ISO</span><span class="o">-</span><span class="mi">8859</span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="n">es_ES</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span><span class="w"> </span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span><span class="w"></span>
<span class="n">es_ES</span><span class="nv">@euro</span><span class="w"> </span><span class="n">ISO</span><span class="o">-</span><span class="mi">8859</span><span class="o">-</span><span class="mi">15</span><span class="w"></span>
<span class="err">#</span><span class="w"> </span><span class="n">Mexico</span><span class="w"></span>
<span class="n">es_MX</span><span class="w"> </span><span class="n">ISO</span><span class="o">-</span><span class="mi">8859</span><span class="o">-</span><span class="mi">1</span><span class="w"></span>
<span class="n">es_MX</span><span class="p">.</span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span><span class="w"> </span><span class="n">UTF</span><span class="o">-</span><span class="mi">8</span><span class="w"></span>
</code></pre></div>


<p><em>02locales</em> define variables de entorno con datos de nuestro lenguaje.</p>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="n">nano</span> <span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">env</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="mi">02</span><span class="n">locales</span>

<span class="o">#</span>
<span class="o">#</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">env</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="mi">02</span><span class="n">locales</span>
<span class="o">#</span>
<span class="n">LANG</span><span class="o">=</span><span class="ss">&quot;es_MX.utf8&quot;</span>
<span class="k">LANGUAGE</span><span class="o">=</span><span class="ss">&quot;es_MX.utf8&quot;</span>
<span class="n">LC_ALL</span><span class="o">=</span><span class="ss">&quot;es_MX.utf8&quot;</span>
</code></pre></div>


<p><em>clock</em> define la zona horaria.</p>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="n">nano</span> <span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">conf</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">clock</span>

<span class="o">#</span>
<span class="o">#</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">conf</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">clock</span>
<span class="o">#</span>

<span class="o">#</span> <span class="k">Set</span> <span class="n">CLOCK</span> <span class="k">to</span> <span class="ss">&quot;UTC&quot;</span> <span class="k">if</span> <span class="n">your</span> <span class="k">system</span> <span class="n">clock</span> <span class="k">is</span> <span class="k">set</span> <span class="k">to</span> <span class="n">UTC</span> <span class="p">(</span><span class="n">also</span> <span class="n">known</span> <span class="k">as</span>
<span class="o">#</span> <span class="n">Greenwich</span> <span class="n">Mean</span> <span class="k">Time</span><span class="p">).</span>  <span class="k">If</span> <span class="n">your</span> <span class="n">clock</span> <span class="k">is</span> <span class="k">set</span> <span class="k">to</span> <span class="n">the</span> <span class="k">local</span> <span class="k">time</span><span class="p">,</span> <span class="k">then</span>
<span class="o">#</span> <span class="k">set</span> <span class="n">CLOCK</span> <span class="k">to</span> <span class="ss">&quot;local&quot;</span><span class="p">.</span>  <span class="n">Note</span> <span class="n">that</span> <span class="k">if</span> <span class="n">you</span> <span class="n">dual</span> <span class="n">boot</span> <span class="k">with</span> <span class="n">Windows</span><span class="p">,</span> <span class="k">then</span>
<span class="o">#</span> <span class="n">you</span> <span class="n">should</span> <span class="k">set</span> <span class="n">it</span> <span class="k">to</span> <span class="ss">&quot;local&quot;</span><span class="p">.</span>

<span class="n">CLOCK</span><span class="o">=</span><span class="ss">&quot;UTC&quot;</span>

<span class="o">#</span> <span class="k">Select</span> <span class="n">the</span> <span class="n">proper</span> <span class="n">timezone</span><span class="p">.</span>  <span class="k">For</span> <span class="k">valid</span> <span class="k">values</span><span class="p">,</span> <span class="n">peek</span> <span class="n">inside</span> <span class="k">of</span> <span class="n">the</span>
<span class="o">#</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">share</span><span class="o">/</span><span class="n">zoneinfo</span><span class="o">/</span> <span class="n">directory</span><span class="p">.</span>  <span class="k">For</span> <span class="n">example</span><span class="p">,</span> <span class="k">some</span> <span class="n">common</span> <span class="k">values</span> <span class="k">are</span>
<span class="o">#</span> <span class="ss">&quot;America/New_York&quot;</span> <span class="k">or</span> <span class="ss">&quot;EST5EDT&quot;</span> <span class="k">or</span> <span class="ss">&quot;Europe/Berlin&quot;</span><span class="p">.</span>  <span class="k">If</span> <span class="n">you</span> <span class="n">want</span> <span class="k">to</span>
<span class="o">#</span> <span class="n">manage</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="k">localtime</span> <span class="n">yourself</span><span class="p">,</span> <span class="k">set</span> <span class="n">this</span> <span class="k">to</span> <span class="ss">&quot;&quot;</span><span class="p">.</span>

<span class="n">TIMEZONE</span><span class="o">=</span><span class="ss">&quot;Mexico/General&quot;</span>
</code></pre></div>


<p><em>consolefont</em> define la fuente y conjunto de caracteres de nuestro idioma.</p>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="n">nano</span> <span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">conf</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">consolefont</span>

<span class="o">#</span>
<span class="o">#</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">conf</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">consolefont</span>
<span class="o">#</span>

<span class="o">#</span> <span class="n">CONSOLEFONT</span> <span class="n">specifies</span> <span class="n">the</span> <span class="k">default</span> <span class="n">font</span> <span class="n">that</span> <span class="n">you</span><span class="s1">&#39;d like Linux to use on the</span>
<span class="s1"># console.  You can find a good selection of fonts in /usr/share/consolefonts;</span>
<span class="s1"># you shouldn&#39;</span><span class="n">t</span> <span class="n">specify</span> <span class="n">the</span> <span class="k">trailing</span> <span class="ss">&quot;.psf.gz&quot;</span><span class="p">,</span> <span class="n">just</span> <span class="n">the</span> <span class="n">font</span> <span class="n">name</span> <span class="n">below</span><span class="p">.</span>
<span class="o">#</span> <span class="k">To</span> <span class="n">use</span> <span class="n">the</span> <span class="k">default</span> <span class="n">console</span> <span class="n">font</span><span class="p">,</span> <span class="k">comment</span> <span class="k">out</span> <span class="n">the</span> <span class="n">CONSOLEFONT</span> <span class="n">setting</span> <span class="n">below</span><span class="p">.</span>
<span class="o">#</span> <span class="n">This</span> <span class="n">setting</span> <span class="k">is</span> <span class="n">used</span> <span class="k">by</span> <span class="n">the</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">init</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">consolefont</span> <span class="n">script</span> <span class="p">(</span><span class="n">NOTE</span><span class="p">:</span> <span class="k">if</span> <span class="n">you</span> <span class="k">do</span>
<span class="o">#</span> <span class="k">not</span> <span class="n">want</span> <span class="k">to</span> <span class="n">use</span> <span class="n">it</span><span class="p">,</span> <span class="n">run</span> <span class="ss">&quot;rc-update del consolefont&quot;</span> <span class="k">as</span> <span class="n">root</span><span class="p">).</span>

<span class="n">CONSOLEFONT</span><span class="o">=</span><span class="ss">&quot;lat9v-16&quot;</span>

<span class="o">#</span> <span class="n">CONSOLETRANSLATION</span> <span class="k">is</span> <span class="n">the</span> <span class="n">charset</span> <span class="k">map</span> <span class="n">file</span> <span class="k">to</span> <span class="n">use</span><span class="p">.</span>  <span class="n">Leave</span> <span class="n">commented</span> <span class="k">to</span> <span class="n">use</span>
<span class="o">#</span> <span class="n">the</span> <span class="k">default</span> <span class="n">one</span><span class="p">.</span>  <span class="n">Have</span> <span class="n">a</span> <span class="n">look</span> <span class="k">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">share</span><span class="o">/</span><span class="n">consoletrans</span> <span class="k">for</span> <span class="n">a</span> <span class="n">selection</span> <span class="k">of</span>
<span class="o">#</span> <span class="k">map</span> <span class="n">files</span> <span class="n">you</span> <span class="n">can</span> <span class="n">use</span><span class="p">.</span>

<span class="n">CONSOLETRANSLATION</span><span class="o">=</span><span class="ss">&quot;8859-1_to_uni&quot;</span>
</code></pre></div>


<p><em>hostname</em> establece el nombre del equipo. En mi caso, le llamo "inspiron".</p>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="n">nano</span> <span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">conf</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">hostname</span>

<span class="o">#</span>
<span class="o">#</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">conf</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">hostname</span>
<span class="o">#</span>
<span class="n">HOSTNAME</span><span class="o">=</span><span class="ss">&quot;inspiron&quot;</span>
</code></pre></div>


<p><em>keymaps</em> tiene que ver con el teclado. El mío es latinoamericano, por lo que uso "la-latin1". Si el suyo es español, defina KEYMAP como "es".</p>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="n">nano</span> <span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">conf</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">keymaps</span>

<span class="o">#</span>
<span class="o">#</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">conf</span><span class="p">.</span><span class="n">d</span><span class="o">/</span><span class="n">keymaps</span>
<span class="o">#</span>

<span class="o">#</span> <span class="n">Use</span> <span class="n">KEYMAP</span> <span class="k">to</span> <span class="n">specify</span> <span class="n">the</span> <span class="k">default</span> <span class="n">console</span> <span class="n">keymap</span><span class="p">.</span>  <span class="n">There</span> <span class="k">is</span> <span class="n">a</span> <span class="n">complete</span> <span class="n">tree</span>
<span class="o">#</span> <span class="k">of</span> <span class="n">keymaps</span> <span class="k">in</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="k">share</span><span class="o">/</span><span class="n">keymaps</span> <span class="k">to</span> <span class="n">choose</span> <span class="k">from</span><span class="p">.</span>

<span class="n">KEYMAP</span><span class="o">=</span><span class="ss">&quot;la-latin1&quot;</span>

<span class="o">#</span> <span class="n">Should</span> <span class="n">we</span> <span class="k">first</span> <span class="k">load</span> <span class="n">the</span> <span class="s1">&#39;windowkeys&#39;</span> <span class="n">console</span> <span class="n">keymap</span><span class="o">?</span>  <span class="n">Most</span> <span class="n">x86</span> <span class="n">users</span> <span class="n">will</span>
<span class="o">#</span> <span class="n">say</span> <span class="ss">&quot;yes&quot;</span> <span class="n">here</span><span class="p">.</span>  <span class="n">Note</span> <span class="n">that</span> <span class="n">non</span><span class="o">-</span><span class="n">x86</span> <span class="n">users</span> <span class="n">should</span> <span class="n">leave</span> <span class="n">it</span> <span class="k">as</span> <span class="ss">&quot;no&quot;</span><span class="p">.</span>

<span class="n">SET_WINDOWKEYS</span><span class="o">=</span><span class="ss">&quot;yes&quot;</span>
</code></pre></div>


<p><em>fstab</em> define el montaje de las particiones del disco duro. Observe que mi root /dev/sda6 es la que estoy instalando.</p>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="n">nano</span> <span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">gentoo</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">fstab</span>

<span class="o">#</span>
<span class="o">#</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">fstab</span>
<span class="o">#</span>
<span class="o">#</span> <span class="o">&lt;</span><span class="n">fs</span><span class="o">&gt;</span>       <span class="o">&lt;</span><span class="n">mountpoint</span><span class="o">&gt;</span>     <span class="o">&lt;</span><span class="k">type</span><span class="o">&gt;</span>      <span class="o">&lt;</span><span class="n">opts</span><span class="o">&gt;</span>      <span class="o">&lt;</span><span class="n">dump</span><span class="o">/</span><span class="n">pass</span><span class="o">&gt;</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda1</span>    <span class="o">/</span><span class="n">boot</span>            <span class="n">ext2</span>        <span class="n">noauto</span>      <span class="mi">1</span> <span class="mi">2</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda2</span>    <span class="o">/</span><span class="n">home</span>            <span class="n">ext3</span>        <span class="k">defaults</span>    <span class="mi">0</span> <span class="mi">0</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda3</span>    <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">portage</span>     <span class="n">reiserfs</span>    <span class="k">defaults</span>    <span class="mi">0</span> <span class="mi">0</span>
<span class="o">#</span> <span class="n">La</span> <span class="n">particion</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda4</span> <span class="n">es</span> <span class="n">EXTENDED</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda5</span>    <span class="k">none</span>             <span class="n">swap</span>        <span class="n">sw</span>          <span class="mi">0</span> <span class="mi">0</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda6</span>    <span class="o">/</span>                <span class="n">ext3</span>        <span class="n">noatime</span>     <span class="mi">0</span> <span class="mi">1</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda7</span>    <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">anterior</span>    <span class="n">ext3</span>        <span class="n">noauto</span>      <span class="mi">0</span> <span class="mi">0</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda8</span>    <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">backup</span>      <span class="n">ext3</span>        <span class="k">defaults</span>    <span class="mi">0</span> <span class="mi">0</span>
<span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda9</span>    <span class="o">/</span><span class="n">mnt</span><span class="o">/</span><span class="n">archivos</span>    <span class="n">ext3</span>        <span class="k">defaults</span>    <span class="mi">0</span> <span class="mi">0</span>
</code></pre></div>


<p><em>resolv.conf</em> es la información de la resolución de nombres. Hago una copia del sistema en uso al nuevo sistema.</p>
<div class="highlight"><pre><span></span><code><span class="err"># cp /etc/resolv.conf /mnt/gentoo/etc/</span>
</code></pre></div>


<p><img class="img-fluid" src="kcmperformance.png"></p>
<h3>Chroot</h3>
<p>Monto las particiones que me apoyarán a la hora de hacer el <em>chroot</em>. Cambie cada /dev/sdaX por la partición correspondiente en su equipo.</p>
<div class="highlight"><pre><span></span><code><span class="err"># mkdir /mnt/gentoo/usr/portage</span>
<span class="err"># mount /dev/sdaX    /mnt/gentoo/boot</span>
<span class="err"># mount /dev/sdaX    /mnt/gentoo/usr/portage</span>
<span class="err"># mount /dev/sdaX    /mnt/gentoo/home</span>
<span class="err"># mount -t proc none /mnt/gentoo/proc</span>
<span class="err"># mount -o bind /dev /mnt/gentoo/dev</span>
</code></pre></div>


<p>Me <em>mudo</em> a la nueva instalación por medio del comando <em>chroot</em>.</p>
<div class="highlight"><pre><span></span><code><span class="err"># chroot /mnt/gentoo /bin/bash</span>
</code></pre></div>


<p>Ya estoy dentro del nuevo GNU/Linux. Actualizo las variables del entorno.</p>
<div class="highlight"><pre><span></span><code><span class="err"># env-update</span>
<span class="err"># source /etc/profile</span>
<span class="err"># export PS1=&quot;(chroot) $PS1&quot;</span>
</code></pre></div>


<p>Copio el archivo del huso horario.</p>
<div class="highlight"><pre><span></span><code><span class="err"># cp /usr/share/zoneinfo/Mexico/General /etc/localtime</span>
</code></pre></div>


<p>Actualizo el <em>caché</em> del <em>portage</em>.</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge --metadata</span>
</code></pre></div>


<p>A raíz de los cambios hechos en /etc/locale.gen hay que ejecutar el comando <em>locale-gen</em>.</p>
<div class="highlight"><pre><span></span><code><span class="err"># locale-gen</span>
</code></pre></div>


<p>Si existe una actualización del paquete <em>portage</em> conviene instalarla antes que nada.</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge -u portage</span>
</code></pre></div>


<p>De forma extraordinaria, usando el stage <em>stage3-i686-2008.0.tar.bz2</em>, hay un conflicto al actualizar el paquete <em>e2fsprogs</em>. Es necesario remover los paquetes anteriores y luego instalar los nuevos. Seguramente estó será arreglado en las futuras versiones del <em>stage</em>.</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge -pu sys-fs/e2fsprogs</span>
<span class="err"># emerge -pC sys-libs/ss sys-libs/com_err sys-fs/e2fsprogs</span>
<span class="err"># emerge -C sys-libs/ss sys-libs/com_err sys-fs/e2fsprogs</span>
<span class="err"># emerge sys-fs/e2fsprogs</span>
</code></pre></div>


<p>Si hay una nueva versión de los compiladores <em>gcc</em> y del <em>glibc</em> conviene actualizarlos de una vez.</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge -u gcc glibc</span>
</code></pre></div>


<p><img class="img-fluid" src="time.png"></p>
<h3>¿Convendrá <em>recompilar</em> todo?</h3>
<p>El <em>stage</em> nos proporciona lo necesario para que el sistema funcione. Entre más antigüo sea, más paquetes deberían actualizarse. Recuerde que he tomado el <em>stage</em> <em>compatible con i686</em>, el cual es para toda la familia de procesadores Pentium 4 y más nuevos.</p>
<p><strong>En este punto tiene que decidir entre sólo actualizar o recompilar todo.</strong></p>
<p>Si sólo quiere que el sistema se <em>actualize</em>, revise (la opción "p") y luego actualize:</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge -pvu system</span>
<span class="err"># emerge -u system</span>
</code></pre></div>


<p>Este paso requiere <em>menos tiempo</em> que <em>recompilar</em> todo. Pero los paquetes que <em>no</em> sean actualizados continuarán como compatibles con el <em>i686</em>.</p>
<p>Si quiere que <em>todo</em> lo instalado por el <em>stage</em> <em>se <em>recompile</em></em> con las opciones de <em>make.conf</em>, revise (la opción "p") y luego <em>recompile</em> todo el <em>system</em>:</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge -pve system</span>
<span class="err"># emerge -e system</span>
</code></pre></div>


<p>Así tendrá todos los paquetes optimizados a su equipo. Obviamente esto requiere <em>más tiempo</em> que sólo actualizar.</p>
<p>Mi recomendación es que si no tiene prisa por terminar la instalación entonces <em><em>recompile</em> todo</em>.</p>
<p><img class="img-fluid" src="services.png"></p>
<h3>Gestor de arranque grub</h3>
<p>Instalo el gestor de arranque <em>grub</em>. Consulte <a href="http://www.gentoo.org/doc/en/handbook/handbook-x86.xml?part=1&amp;chap=10#doc_chap2">Installing GRUB</a> para más información sobre estos pasos.</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge grub</span>
<span class="err"># grub</span>
<span class="err">grub&gt; root (hd0,0)</span>
<span class="err">grub&gt; setup (hd0)</span>
<span class="err">grub&gt; quit</span>
</code></pre></div>


<p><img class="img-fluid" src="kdmconfig.png"></p>
<h3>Kernel</h3>
<p>Para instalar la más nueva versión estable de <em>gentoo-sources</em>, ejecuto:</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge -p gentoo-sources</span>
<span class="err"># emerge gentoo-sources</span>
</code></pre></div>


<p>En cambio, si se necesita una versión específica y estable de <em>gentoo-sources</em> por ejemplo la <em>2.6.24-r8</em>, ejecuto:</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge -p =gentoo-sources-2.6.24-r8</span>
<span class="err"># emerge =gentoo-sources-2.6.24-r8</span>
</code></pre></div>


<p>Copio el <a href="config-2.6.24-gentoo-r8.txt">archivo de configuracion</a> del <em>kernel</em> de la instalación anterior, así me ahorro la ardua tarea de configurarlo. Haga esto sólo si se trata de la misma versión.</p>
<div class="highlight"><pre><span></span><code><span class="err"># cp /mnt/anterior/usr/src/linux/.config /usr/src/linux/</span>
</code></pre></div>


<p>Compilo e instalo el <em>kernel</em> y sus módulos.</p>
<div class="highlight"><pre><span></span><code><span class="err"># cd /usr/src/linux</span>
<span class="err"># make</span>
<span class="err"># make modules_install</span>
<span class="err"># make install</span>
</code></pre></div>


<p>Configuro el gestor de arranque editando el archivo <em>grub.conf</em></p>
<div class="highlight"><pre><span></span><code><span class="err"># nano -w /boot/grub/grub.conf</span>
</code></pre></div>


<p>Revise dos veces la configuración en <em>grub.conf</em> antes de reiniciar. En el mío tengo dos instalaciones de Gentoo Linux, una en <em>/dev/sda6</em> (nuevo) y la otra en <em>/dev/sda7</em> (anterior). Además le paso el parámetro <em>resume</em> con la participación <em>swap</em> <em>/dev/sda5</em>, esto es para la hibernación a disco duro.</p>
<div class="highlight"><pre><span></span><code><span class="k">default</span> <span class="mi">0</span>
<span class="n">timeout</span> <span class="mi">5</span>

<span class="n">title</span> <span class="n">Gentoo</span> <span class="n">Linux</span> <span class="o">-</span> <span class="n">Anterior</span> <span class="o">-</span> <span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">24</span><span class="o">-</span><span class="n">r8</span>
<span class="n">root</span> <span class="p">(</span><span class="n">hd0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">kernel</span> <span class="o">/</span><span class="n">vmlinuz</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">24</span><span class="o">-</span><span class="n">gentoo</span><span class="o">-</span><span class="n">r8</span> <span class="n">root</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda7</span> <span class="n">resume</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda5</span>

<span class="n">title</span> <span class="n">Gentoo</span> <span class="n">Linux</span> <span class="o">-</span> <span class="n">NUEVO</span>    <span class="o">-</span> <span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">24</span><span class="o">-</span><span class="n">r8</span>
<span class="n">root</span> <span class="p">(</span><span class="n">hd0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="n">kernel</span> <span class="o">/</span><span class="n">vmlinuz</span><span class="o">-</span><span class="mi">2</span><span class="p">.</span><span class="mi">6</span><span class="p">.</span><span class="mi">24</span><span class="o">-</span><span class="n">gentoo</span><span class="o">-</span><span class="n">r8</span> <span class="n">root</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda6</span> <span class="n">resume</span><span class="o">=/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda5</span>
</code></pre></div>


<p><img class="img-fluid" src="kcmcgi.png"></p>
<h3>Paquetes necesarios antes del primer arranque</h3>
<p>Instalo el demonio para administrar las bitácoras del sistema o <em>logger</em>. Mi elección es el <em>syslog-ng</em>.</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge syslog-ng</span>
<span class="err"># rc-update syslog-ng add default</span>
</code></pre></div>


<p>El calendarizador sirve para ejecutar programas a ciertas horas o días. Mi preferido es el <em>vixie-cron</em>.</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge vixie-cron</span>
<span class="err"># rc-update vixie-cron add default</span>
</code></pre></div>


<p>El demonio <em>ACPI</em> tiene que ver con el control del equipo y la administración de la energía.</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge acpid</span>
<span class="err"># rc-update add acpid default</span>
</code></pre></div>


<p>Las siguientes utilerías me son prácticamente indispensables.</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge gentoolkit</span>
<span class="err"># emerge reiserfsprogs</span>
<span class="err"># emerge dhcpcd</span>
<span class="err"># emerge dosfstools</span>
<span class="err"># emerge pciutils</span>
<span class="err"># emerge usbutils</span>
<span class="err"># emerge sudo</span>
<span class="err"># emerge screen</span>
</code></pre></div>


<p><img class="img-fluid" src="personal.png"></p>
<h3>Contraseñas y primer uso</h3>
<p>Defino la contraseña del superusuario <em>root</em>.</p>
<div class="highlight"><pre><span></span><code><span class="err"># passwd</span>
</code></pre></div>


<p>Es momento de dar de alta al usuario que uso normalmente por medio del comando <em>useradd</em>. El parámetro <em>-m</em> es para crear el directorio <em>/home/nombre_del_usuario</em>. Si ese directorio ya existe, debe omitir ese parámetro. Cambie <em>guivaloz</em> por su propio <em>nickname</em>.</p>
<div class="highlight"><pre><span></span><code><span class="err"># useradd -g users -G tty,wheel,audio,cdrom,video,portage,cron,usb -m guivaloz</span>
<span class="err"># passwd guivaloz</span>
</code></pre></div>


<p>Abandono el <em>chroot</em>.</p>
<div class="highlight"><pre><span></span><code><span class="err"># exit</span>
</code></pre></div>


<p>Reinicio el equipo. Arranco con la nueva instalación y pruebo que funcione bien.</p>
<p><img class="img-fluid" src="kcmpci.png"></p>
<h3>Audio, red alámbrica y red inalámbrica</h3>
<p>Instalo las utilerías de <em>ALSA</em> para usar mi tarjeta de audio.</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge alsa-utils</span>
</code></pre></div>


<p>Debo configurar <em>ALSA</em> para mi equipo editando el archivo <em>/etc/modules.d/alsa</em></p>
<div class="highlight"><pre><span></span><code><span class="err"># nano -w /etc/modules.d/alsa</span>
</code></pre></div>


<p>El contenido de ese archivo es:</p>
<div class="highlight"><pre><span></span><code><span class="o">#</span> <span class="n">ALSA</span> <span class="n">portion</span>
<span class="k">alias</span> <span class="nb">char</span><span class="o">-</span><span class="n">major</span><span class="o">-</span><span class="mi">116</span> <span class="n">snd</span>
<span class="k">alias</span> <span class="n">snd</span><span class="o">-</span><span class="n">card</span><span class="o">-</span><span class="mi">0</span> <span class="n">snd</span><span class="o">-</span><span class="n">intel8x0</span>

<span class="o">#</span> <span class="n">OSS</span><span class="o">/</span><span class="k">Free</span> <span class="n">portion</span>
<span class="k">alias</span> <span class="nb">char</span><span class="o">-</span><span class="n">major</span><span class="o">-</span><span class="mi">14</span> <span class="n">soundcore</span>
<span class="k">alias</span> <span class="n">sound</span><span class="o">-</span><span class="n">slot</span><span class="o">-</span><span class="mi">0</span> <span class="n">snd</span><span class="o">-</span><span class="n">card</span><span class="o">-</span><span class="mi">0</span>

<span class="o">#</span> <span class="n">Tarjeta</span> <span class="n">de</span> <span class="n">audio</span> <span class="n">interna</span> <span class="n">Intel</span>
<span class="k">alias</span> <span class="n">sound</span><span class="o">-</span><span class="n">service</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">0</span> <span class="n">snd</span><span class="o">-</span><span class="n">mixer</span><span class="o">-</span><span class="n">oss</span>
<span class="k">alias</span> <span class="n">sound</span><span class="o">-</span><span class="n">service</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">1</span> <span class="n">snd</span><span class="o">-</span><span class="n">seq</span><span class="o">-</span><span class="n">oss</span>
<span class="k">alias</span> <span class="n">sound</span><span class="o">-</span><span class="n">service</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">3</span> <span class="n">snd</span><span class="o">-</span><span class="n">pcm</span><span class="o">-</span><span class="n">oss</span>
<span class="k">alias</span> <span class="n">sound</span><span class="o">-</span><span class="n">service</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">8</span> <span class="n">snd</span><span class="o">-</span><span class="n">seq</span><span class="o">-</span><span class="n">oss</span>
<span class="k">alias</span> <span class="n">sound</span><span class="o">-</span><span class="n">service</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">12</span> <span class="n">snd</span><span class="o">-</span><span class="n">pcm</span><span class="o">-</span><span class="n">oss</span>

<span class="o">#</span> <span class="k">Alias</span>
<span class="k">alias</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">mixer</span> <span class="n">snd</span><span class="o">-</span><span class="n">mixer</span><span class="o">-</span><span class="n">oss</span>
<span class="k">alias</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">dsp</span> <span class="n">snd</span><span class="o">-</span><span class="n">pcm</span><span class="o">-</span><span class="n">oss</span>
<span class="k">alias</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">midi</span> <span class="n">snd</span><span class="o">-</span><span class="n">seq</span><span class="o">-</span><span class="n">oss</span>

<span class="o">#</span> <span class="k">Set</span> <span class="n">this</span> <span class="k">to</span> <span class="n">the</span> <span class="n">correct</span> <span class="nb">number</span> <span class="k">of</span> <span class="n">cards</span><span class="p">.</span>
<span class="k">options</span> <span class="n">snd</span> <span class="n">cards_limit</span><span class="o">=</span><span class="mi">1</span>
</code></pre></div>


<p>Para terminar a lo que a <em>ALSA</em> se refiere; configuro que se cargue en el arranque con:</p>
<div class="highlight"><pre><span></span><code><span class="err"># rc-update add alsasound boot</span>
</code></pre></div>


<p>Para una computadora portátil conviene que la red alámbrica se levante al conectar el cable ethernet, para ello instalo <em>netplug</em>.</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge netplug</span>
</code></pre></div>


<p>También tengo una tarjeta de red inalámbrica <em>Intel IPW2200</em>.</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge wireless-tools</span>
<span class="err"># emerge ipw2200-firmware</span>
</code></pre></div>


<p><img class="img-fluid" src="editcopy.png"></p>
<h3>Respaldo o clono lo que llevo al momento</h3>
<p>Antes de respaldar o clonar hay que a revisar si se necesitan más actualizaciones. El siguiente comando incluye <em>-N</em> que busca paquetes por recompilar si han cambiado los parámetros de la variable <em>USE</em> que le correspondan. Como es recomendable, primero revisamos y luego actualizamos.</p>
<div class="highlight"><pre><span></span><code><span class="err"># emerge -puvND world</span>
<span class="err"># emerge -uND world</span>
</code></pre></div>


<p>Después, ejecuto el comando <em>python-updater</em> por si algunas aplicaciones necesiten ser recompiladas por una posible actualización del <em>phyton</em>.</p>
<div class="highlight"><pre><span></span><code><span class="err"># python-updater</span>
</code></pre></div>


<p>Por último, para asegurarnos que las relaciones entre los paquetes instalados no estén rotas, ejecuto <em>revdep-rebuild</em>.</p>
<div class="highlight"><pre><span></span><code><span class="err"># revdep-rebuild</span>
</code></pre></div>


<p>En este punto, mi <em>instalación básica</em> está lista. El siguiente paso que sugiero es <em>respaldarla</em> o <em>clonarla</em>. <em>¿Para qué?</em> se preguntará... bueno, para ahorrarse el tener que repetir todo el proceso de instalación si se arrepiente de algún paso. O bien, a partir de aquí puede, por ejemplo, instalar Gnome o KDE; si tiempo más adelante ya no le gustó su instalación, puede <em>formatear</em> esa partición y restablecer a partir del respaldo de la <em>instalación básica</em>, lo actualiza e instala un nuevo Gnome o KDE; esto le llevará menos tiempo que hacer todo este procedimiento de nuevo.</p>
<p><strong>MUY IMPORTANTE: Para respaldar o clonar un sistema operativo Gentoo Linux debe de arrancar con un Live CD o con otra instalación GNU/Linux que tenga en su equipo.</strong> Si copia o clona una instalación que esté usando, podría fallar o quedar corrupta.</p>
<p>En mi caso ya tengo una instalación anterior en mi portátil, así que reinicio el equipo y arranco con ésta.</p>
<p><strong>ADVERTENCIA:</strong> Tenga mucho cuidado con las siguientes instrucciones, en un descuido podría hechar a perder su trabajo.</p>
<p><strong>Para hacer un respaldo</strong> (ya en la instalación anterior) monto la partición con la nueva instalación y ejecuto los comandos siguientes para crear un archivo comprimido. Observe que omito el directorio <em>lost+found</em> propio del sistema bajo el que fue <em>formateado</em>, el <em>ext3</em>. Sustituya <em>/dev/sdaX</em> por la partición que corresponda.</p>
<div class="highlight"><pre><span></span><code><span class="err"># mkdir /mnt/gentoo</span>
<span class="err"># mount /dev/sdaX /mnt/gentoo</span>
<span class="err"># cd /mnt/gentoo</span>
<span class="err"># tar cvzf /home/guivaloz/software/inspiron_basico_2008-11-10.tar.gz --exclude=lost+found *</span>
<span class="err"># chown guivaloz:users /home/guivaloz/software/inspiron_basico_2008-11-10.tar.gz</span>
</code></pre></div>


<p>Opcionalmente puede conservar una copia del <em>portage</em> correspondiente a la misma instalación que haya respaldado.</p>
<div class="highlight"><pre><span></span><code><span class="err"># cd /usr/portage/</span>
<span class="err"># tar cvzf /home/guivaloz/software/inspiron_basico_portage_2008-11-10.tar.gz --exclude=distfiles --exclude=packages *</span>
<span class="err"># chown guivaloz:users /home/guivaloz/software/inspiron_basico_portage_2008-11-10.tar.gz</span>
</code></pre></div>


<p><strong>Para reestablecer</strong> a partir de un respaldo, debe ejecutar:</p>
<div class="highlight"><pre><span></span><code><span class="err"># mkfs.ext3 /dev/sdaX</span>
<span class="err"># mkdir /mnt/gentoo</span>
<span class="err"># mount /dev/sdaX /mnt/gentoo</span>
<span class="err"># cd /mnt/gentoo</span>
<span class="err"># tar xvzf /home/guivaloz/software/inspiron_basico_2008-11-10.tar.gz</span>
</code></pre></div>


<p><strong>Para hacer un clon (una copia idéntica en otra partición)</strong> <em>formateo</em> la partición a donde irá el <em>clon</em> y monto esa y la original (la que tiene la nueva instalación). Sustituya <em>/dev/sdaX</em> (nueva instalación) y <em>/dev/sdaY</em> (clon) por lo que corresponda.</p>
<div class="highlight"><pre><span></span><code><span class="err"># mkdir /mnt/original</span>
<span class="err"># mount /dev/sdaX /mnt/original</span>
<span class="err"># mkfs.ext3 /dev/sdaY</span>
<span class="err"># mkdir /mnt/clon</span>
<span class="err"># mount /dev/sdaY /mnt/clon</span>
</code></pre></div>


<p>Uso el comando <em>tar</em> con una tubería, omitiendo el directorio <em>lost+found</em>. Esta técnica es bastante más rápida que el comando <em>cp</em>.</p>
<div class="highlight"><pre><span></span><code><span class="err"># cd /mnt/original</span>
<span class="err"># tar cv --exclude=lost+found * | tar x -C /mnt/clon/</span>
</code></pre></div>


<p><img class="img-fluid" src="configure.png"></p>
<h3>Cambios en el clon</h3>
<p>Si desea arrancar con el <em>clon</em>, hay que modificar el archivo de configuración <em>fstab</em> del <em>clon</em>. Debemos cambiar la línea que defina la raiz del sistema (<em>/dev/sdaY</em>) y también la que apunta a la otra instalación (<em>/dev/sdaX</em>).</p>
<div class="highlight"><pre><span></span><code><span class="err"># nano -w /mnt/clon/etc/fstab</span>
</code></pre></div>


<p>También debe modificar la configuración del gestor de arranque <em>grub</em> para que pueda usar ambas instalaciones. Un buen truco es usar el mismo kernel para ambas (ya que son <em>clones</em>).</p>
<div class="highlight"><pre><span></span><code><span class="err"># mount /boot</span>
<span class="err"># nano -w /boot/grub/grub.conf</span>
</code></pre></div>


<p>Desmonte las particiones, reinicie y pruebe cada una de ellas.</p>
<p>Vea la <a href="gentoo-linux-mi-instalacion-personal-2.html">segunda parte de este manual</a> para continuar con la instalación.</p>
                </article>
            </div>
            <div class="col-sm-4">
                <aside>
                    <div class="card my-4 movimientolibre-card aside-about">
                        <h5 class="card-header movimientolibre-card-header">A cerca de</h5>
                        <div class="card-body">
                            <p class="card-text">
                                Este es un sitio web que busca divulgar
                                conocimiento y promover el uso de software libre.
                                Su creador es reconocido como desarrollador que
                                fabrica estas herramientas tanto para entidades
                                públicas como privadas.
                            </p>
                        </div>
                    </div>
                    <div class="card my-4 movimientolibre-card">
                        <h5 class="card-header movimientolibre-card-header">Etiquetas</h5>
                        <div class="card-body">
                            <ul class="list-unstyled mb-0">
                                <li><a href="/tag/astronomia.html">astronomía</a></li>
                                <li><a href="/tag/ciencia-de-datos.html">ciencia de datos</a></li>
                                <li><a href="/tag/conferencias.html">conferencias</a></li>
                                <li><a href="/tag/contenedores.html">contenedores</a></li>
                                <li><a href="/tag/desarrollo.html">desarrollo</a></li>
                                <li><a href="/tag/educacion.html">educación</a></li>
                                <li><a href="/tag/fedora.html">fedora</a></li>
                                <li><a href="/tag/flisol.html">flisol</a></li>
                                <li><a href="/tag/gentoo-linux.html">gentoo linux</a></li>
                                <li><a href="/tag/git.html">git</a></li>
                                <li><a href="/tag/gnu-linux.html">gnu linux</a></li>
                                <li><a href="/tag/gulag.html">gulag</a></li>
                                <li><a href="/tag/hardware.html">hardware</a></li>
                                <li><a href="/tag/kde.html">kde</a></li>
                                <li><a href="/tag/kernel-linux.html">kernel linux</a></li>
                                <li><a href="/tag/latex.html">latex</a></li>
                                <li><a href="/tag/markdown.html">markdown</a></li>
                                <li><a href="/tag/php.html">php</a></li>
                                <li><a href="/tag/politica.html">política</a></li>
                                <li><a href="/tag/postgresql.html">postgresql</a></li>
                                <li><a href="/tag/python.html">python</a></li>
                                <li><a href="/tag/ruby.html">ruby</a></li>
                                <li><a href="/tag/servidores.html">servidores</a></li>
                                <li><a href="/tag/software-libre.html">software libre</a></li>
                                <li><a href="/tag/vida-cotidiana.html">vida cotidiana</a></li>
                                <li><a href="/tag/wallpapers.html">wallpapers</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="card my-4 movimientolibre-card">
                        <h5 class="card-header movimientolibre-card-header">Buscar</h5>
                        <div class="card-body">
                            <script>
                                (function() {
                                    var cx = '015464194519155410478:jqayrodgycs';
                                    var gcse = document.createElement('script');
                                    gcse.type = 'text/javascript';
                                    gcse.async = true;
                                    gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
                                    var s = document.getElementsByTagName('script')[0];
                                    s.parentNode.insertBefore(gcse, s);
                                })();
                            </script>
                            <gcse:search></gcse:search>
                        </div>
                    </div>
                </aside>
            </div>
        </div>
    </div>
    <footer class="text-muted">
        <div class="container">
            <hr>
            <p>
                Copyright &copy; 2006-2020 Guillermo Valdés Lozano.
                Protegidos por la licencia <a href="/licencias/gfdl-es/">GFDL</a>.
                Se otorga permiso para copiar, distribuir y/o modificar estos documentos.
                Sitio web elaborado con <a href="https://blog.getpelican.com/">Pelican</a> que es programado en <a href="https://python.org/">Python</a>; el código fuente está en <a href="https://github.com/MovimientoLibre/plataforma.web">GitHub</a> protegido por la licencia <a href="/licencias/gpl-2-es/">GPLv3</a>.
            </p>
        </div>
    </footer>
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js" integrity="sha384-wHAiFfRlMFy6i5SRaxvfOCifBUQy1xHdJ/yoi7FRNXMRBu5WHdZYu1hA6ZOblgut" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.2.1/js/bootstrap.min.js" integrity="sha384-B0UglyR+jN6CkvvICOB2joaf5I4l3gm9GU6Hc1og6Ls7i6U/mkkaduKaBhlAXv9k" crossorigin="anonymous"></script>
    <script src="/theme/js/movimiento-libre.js"></script>
</body>
</html>
